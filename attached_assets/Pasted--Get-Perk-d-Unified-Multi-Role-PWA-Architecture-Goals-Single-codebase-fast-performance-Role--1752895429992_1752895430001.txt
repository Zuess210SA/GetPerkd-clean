ğŸ§± Get Perkâ€™d: Unified Multi-Role PWA Architecture
âœ… Goals:
Single codebase, fast performance

Role-based route protection

Modular components per user group

Lazy loading + clean UI/UX separation

ğŸ“ Folder Structure (Replit-Ready)
bash
Copy
Edit
/src
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ common/                  # Reusable UI (buttons, modals, toasts)
â”‚   â”œâ”€â”€ student/                 # QR cards, challenge UI, reward shop
â”‚   â”œâ”€â”€ merchant/                # Deal editor, redemption stats
â”‚   â”œâ”€â”€ franchisee/              # Territory analytics, onboarding tools
â”‚   â””â”€â”€ admin/                   # Master dashboards, user controls
â”‚
â”œâ”€â”€ context/
â”‚   â”œâ”€â”€ AuthContext.tsx          # Global auth + user data
â”‚   â””â”€â”€ RoleContext.tsx          # Role-based access control
â”‚
â”œâ”€â”€ layouts/
â”‚   â”œâ”€â”€ StudentLayout.tsx
â”‚   â”œâ”€â”€ MerchantLayout.tsx
â”‚   â”œâ”€â”€ FranchiseeLayout.tsx
â”‚   â”œâ”€â”€ AdminLayout.tsx
â”‚   â””â”€â”€ AuthLayout.tsx           # Login/signup wrapper
â”‚
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ login.tsx
â”‚   â”œâ”€â”€ register.tsx
â”‚
â”‚   â”œâ”€â”€ student/
â”‚   â”‚   â”œâ”€â”€ index.tsx            # Dashboard
â”‚   â”‚   â”œâ”€â”€ deals.tsx
â”‚   â”‚   â”œâ”€â”€ rewards.tsx
â”‚   â”‚   â”œâ”€â”€ challenges.tsx
â”‚   â”‚   â”œâ”€â”€ leaderboard.tsx
â”‚   â”‚   â””â”€â”€ profile.tsx
â”‚
â”‚   â”œâ”€â”€ merchant/
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ create-deal.tsx
â”‚   â”‚   â”œâ”€â”€ manage-deals.tsx
â”‚   â”‚   â”œâ”€â”€ staff.tsx
â”‚   â”‚   â””â”€â”€ feedback.tsx
â”‚
â”‚   â”œâ”€â”€ franchisee/
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ analytics.tsx
â”‚   â”‚   â”œâ”€â”€ tools.tsx
â”‚   â”‚   â”œâ”€â”€ ambassador-management.tsx
â”‚   â”‚   â””â”€â”€ crm.tsx
â”‚
â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ manage-users.tsx
â”‚   â”‚   â”œâ”€â”€ system-health.tsx
â”‚   â”‚   â”œâ”€â”€ billing.tsx
â”‚   â”‚   â””â”€â”€ fraud.tsx
â”‚
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ PrivateRoute.tsx         # Protects role-specific routes
â”‚
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ api.ts                   # Supabase / fetch helpers
â”‚   â””â”€â”€ constants.ts             # Campus roles, categories, etc
â”‚
â”œâ”€â”€ i18n/
â”‚   â”œâ”€â”€ en.json
â”‚   â”œâ”€â”€ es.json
â”‚   â”œâ”€â”€ regional/
â”‚   â”‚   â”œâ”€â”€ utsa.json
â”‚   â”‚   â”œâ”€â”€ txstate.json
â”‚   â”‚   â”œâ”€â”€ alamo.json
â”‚   â”‚   â””â”€â”€ utaustin.json
â”‚   â””â”€â”€ i18nConfig.ts
â”‚
â””â”€â”€ App.tsx
ğŸ” PrivateRoute.tsx (Role-Based Route Guard)
tsx
Copy
Edit
import { useContext } from 'react';
import { Navigate } from 'react-router-dom';
import { AuthContext } from '../context/AuthContext';

export default function PrivateRoute({ children, allowedRoles }) {
  const { user } = useContext(AuthContext);
  if (!user?.isAuthenticated) return <Navigate to="/login" />;
  if (!allowedRoles.includes(user.role)) return <Navigate to={`/${user.role}`} />;
  return children;
}
ğŸ§  Role Mapping Guide
Role	Homepage	Folder	Layout File
student	/student	/student/	StudentLayout.tsx
merchant	/merchant	/merchant/	MerchantLayout.tsx
franchisee	/franchisee	/franchisee/	FranchiseeLayout.tsx
admin	/admin	/admin/	AdminLayout.tsx

ğŸš¦ Dynamic Navbar / Menu Logic
tsx
Copy
Edit
const renderNav = (role) => {
  switch (role) {
    case 'student': return <StudentNavbar />;
    case 'merchant': return <MerchantNavbar />;
    case 'franchisee': return <FranchiseeNavbar />;
    case 'admin': return <AdminNavbar />;
    default: return null;
  }
};
ğŸš€ Performance Enhancements
Technique	Purpose
React.lazy() + Suspense	Split code by role + layout
CDN Caching	Speed for regional campus users
LocalStorage for i18n	Remember userâ€™s language/campus
Static Routes per Role	Clean URLs and faster page loads

ğŸ§© Optional Enhancements (Want these added?)
âœ… Per-role custom error pages (403 Unauthorized)

âœ… Role-based analytics module

âœ… Route prefetching for likely destinations

âœ… Campus-specific theming based on subdomain or login

ğŸ¯ Ready to Implement?
Just say the word and Iâ€™ll prep:

âœ… Starter layout files

âœ… PrivateRoute logic

âœ… Folder structure in Replit

âœ… Setup QA for routing, role flow, and i18n together

Wanna deploy this as a Phase 4 refactor before the UTSA launch? Or prep the build doc so Replit can copy/paste the whole architecture in?